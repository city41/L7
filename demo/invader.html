<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Invader demo</title>

	<script type="text/javascript" src="gl-matrix-min.js"></script>
	<script type="text/javascript" src="../lib/third/underscore-min.js"></script>
	<script type="text/javascript" src="../lib_min/l7.debug.js"></script>
	<script type="text/javascript" src="../lib/game/Game.js"></script>
	<script type="text/javascript" src="../lib/board/Board.js"></script>

</head>
<body>
<script id="shader-fs" type="x-shader/x-fragment">
    precision mediump float;

    varying vec4 vColor;

    void main(void) {
        gl_FragColor = vColor;
    }
</script>

<script id="shader-vs" type="x-shader/x-vertex">
    attribute vec3 aVertexPosition;
    //attribute vec4 aVertexColor;
		uniform vec4 uColor;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec4 vColor;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vColor = uColor;
    }
</script>

	<script type="text/javascript">
		L7.Keys.init();

		var board = new L7.Board({
			width: 30,
			height: 30,
			borderWidth: 2,
			borderFill: 'black',
			tileSize: 10
		});

		var c = ['#003388', '#223499', '#000055', 'black'];
			

		board.tiles.forEach(function(tile, index) {
			tile.color = L7.Color.toArray(c[index % c.length]);
		});
	
	function rand(max) {
		return Math.round(Math.random() * max);
	}

	var ki = {
				r: {
					repeat: true,
					handler: function() {
						this.rotate();
					}
				},
				left: {
					repeat: true,
					handler: function() {
						this.left(1);
					}
				},
				right: {
					repeat: true,
					handler: function() {
						this.right(1);
					}
				},
				up: {
					repeat: true,
					handler: function() {
						this.up(1);
					}
				},
				down: {
					repeat: true,
					handler: function() {
						this.down(1);
					}
				}
			};

		var a = new L7.Actor({
			keyInputs: ki,
			position: L7.p(10, 10),
			shape: [
				[0,0,1,0,0,0,0,0,1,0,0],
				[0,0,0,1,0,0,0,1,0,0,0],
				[0,0,1,1,1,1,1,1,1,0,0],
				[0,1,1,0,1,1,1,0,1,1,0],
				[1,1,1,1,1,5,1,1,1,1,1],
				[1,0,1,1,1,1,1,1,1,0,1],
				[1,0,1,0,0,0,0,0,1,0,1],
				[0,0,0,1,1,0,1,1,0,0,0]
			],
			color: [255, 0, 0, 1]
		});


		board.addActor(a);

		var game = new L7.Game(board);
		game.webgl = true;
		game.go();

	</script>
</body>
</html>



