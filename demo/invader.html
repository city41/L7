<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Invader demo</title>

	<script type="text/javascript" src="../lib/third/underscore-min.js"></script>
	<script type="text/javascript" src="../lib/bootstrap.js"></script>
  <script type="text/javascript" src="../lib/util/Array.js"></script>
	<script type="text/javascript" src="../lib/geometry/Pair.js"></script>
	<script type="text/javascript" src="../lib/board/Piece.js"></script>
	<script type="text/javascript" src="../lib/board/Tile.js"></script>
	<script type="text/javascript" src="../lib/board/Board.js"></script>
	<script type="text/javascript" src="../lib/board/HitManager.js"></script>
	<script type="text/javascript" src="../lib/board/Actor.js"></script>
	<script type="text/javascript" src="../lib/kernel/Kernel.js"></script>
	<script type="text/javascript" src="../lib/kernel/Keys.js"></script>
	<script type="text/javascript" src="../lib/color/Color.js"></script>

</head>
<body>
	<div id="container" style="width: 340px; height: 540px; margin-left: auto; margin-right: auto; margin-top: 40px"></div>
	<script type="text/javascript">
		L7.Keys.init();

		var board = new L7.Board({
			width: 30,
			height: 50,
			borderWidth: 3,
			tileSize: 10,
			container: document.getElementById('container'),
			viewportWidth: 30,
			viewportHeight: 20,
			viewportAnchor: L7.p(0, 10),
			preventOverscroll: true
		});

		window.board = board;

		var c = ['#003388', '#223499', '#000055', 'black'];
			

		board.tiles.forEach(function(tile, index) {
			tile.color = L7.Color.toArray(c[index % c.length]);
		});
	
	function rand(max) {
		return Math.round(Math.random() * max);
	}

	var ki = {
				r: {
					repeat: true,
					handler: function() {
						this.rotate();
					}
				},
				left: {
					repeat: true,
					handler: function() {
						this.left(1);
					}
				},
				right: {
					repeat: true,
					handler: function() {
						this.right(1);
					}
				},
				up: {
					repeat: true,
					handler: function() {
						this.up(1);
					}
				},
				down: {
					repeat: true,
					handler: function() {
						this.down(1);
					}
				}
			};

	for(var i = 4; i < board.width; i += 9) {
	for(var k = 1; k < board.height; k += 8) {
		var a = new L7.Actor({
			keyInputs: (i === 4 && k === 1) ? ki : undefined, 
			position: L7.p(i, k),
			shape: [
				[0,0,1,0,0,0,0,0,1,0,0],
				[0,0,0,1,0,0,0,1,0,0,0],
				[0,0,1,1,1,1,1,1,1,0,0],
				[0,1,1,0,1,1,1,0,1,1,0],
				[1,1,1,1,1,5,1,1,1,1,1],
				[1,0,1,1,1,1,1,1,1,0,1],
				[1,0,1,0,0,0,0,0,1,0,1],
				[0,0,0,1,1,0,1,1,0,0,0]
			],
			/*color: 'rgba(255, 0, 0, .5)',*/
			/*color: '#FF0000',*/
			color: [k * 4, i * 3, 0, .5],
			/*onOutOfBounds: function() {*/
				/*this.goBack();*/
			/*}*/
		});


		board.addActor(a);
		}
		}

		board.addActor(new L7.Actor({
			timers: {
				scroll: {
					handler: function() {
						board.scrollY(-1)
					},
					interval: 300
				}
			}
		}));

		new L7.Kernel(board).go();
	</script>
</body>
</html>



